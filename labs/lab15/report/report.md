---
## Front matter
title: "Отчёт по лабораторной работе №15"
subtitle: "Управление логическими томами"
author: "Анастасия Мазуркевич"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки управления логическими томами.

# Ход выполнения

## Создание физического тома

Перед началом работы строки автомонтирования в `/etc/fstab`, относящиеся к каталогам `/mnt/data` и `/mnt/data-ext`, были закомментированы. После этого каталоги были отмонтированы. Проверка вывода команды `mount` показала отсутствие смонтированных устройств `/dev/sdb` и `/dev/sdc`.

Затем проведена новая разметка диска `/dev/sdb`. Через `fdisk` создан новый основной раздел, предыдущая разметка была удалена путём создания новой DOS-таблицы. После записи изменений таблица разделов обновлена.

![Разметка /dev/sdb](Screenshot_1.png){ #fig:001 width=70% }

Создан физический том:

Физический том `/dev/sdb1` успешно добавлен, что подтверждено выводом списка физических томов.

![Физический том /dev/sdb1](Screenshot_2.png){ #fig:002 width=70% }

## Создание группы томов и логического тома

Проверена доступность физических томов. Затем была создана группа томов `vgdata`, включающая физический том `/dev/sdb1`.

![Создание VG vgdata](Screenshot_3.png){ #fig:003 width=70% }

После подтверждения успешного создания группы томов был создан логический том `lvdata`, использующий 50% свободного пространства группы томов. На созданном логическом томе была создана файловая система ext4.

![Создание ФС ext4 на lvdata](Screenshot_4.png){ #fig:004 width=70% }

Создан каталог `/mnt/data`, после чего соответствующая запись добавлена в `/etc/fstab`. Проверка показала успешное подключение файловой системы.

![Проверка монтирования /mnt/data](Screenshot_5.png){ #fig:005 width=70% }

## Изменение размера логических томов

Для увеличения available-пространства был создан новый раздел `/dev/sdb2` размером 100 МБ с типом LVM (8e).

![Создание раздела /dev/sdb2](Screenshot_6.png){ #fig:006 width=70% }

После создания физического тома на базе нового раздела группа томов `vgdata` была расширена. Проверка состояния группы томов показала увеличение свободного пространства.

![Расширенная VG vgdata](Screenshot_7.png){ #fig:007 width=70% }

Затем был увеличен размер логического тома `lvdata` на 50% от доступного свободного пространства. Изменения применились также и к файловой системе, что подтверждено проверкой.

![Расширение lvdata](Screenshot_8.png){ #fig:008 width=70% }

После этого выполнено уменьшение тома на 50 МБ, в ходе которого логический том временно размонтировался. По завершении операция прошла успешно.

![Уменьшение размера lvdata](Screenshot_9.png){ #fig:009 width=70% }

Проверка вывода `lvs` и состояния файловой системы подтвердила корректное изменение размера тома и доступного пространства.

## Самостоятельная работа

Для начала на диске `/dev/sdc` была выполнена разметка: созданы два раздела — `sdc1` размером 600 МБ и `sdc2` размером 450 МБ, оба с типом **Linux LVM (8e)**.

![Разметка диска /dev/sdc](Screenshot_10.png){ #fig:010 width=70% }

После сохранения новой таблицы разделов был создан физический том на разделе `/dev/sdc1`.

![Создание PV на /dev/sdc1](Screenshot_11.png){ #fig:011 width=70% }

Далее была создана группа томов `vggroup`, включающая физический том `/dev/sdc1`. На базе группы томов создан логический том `lvgroup` размером **200 МБ**.

![Создание VG и LV](Screenshot_12.png){ #fig:012 width=70% }

Логический том был отформатирован в файловой системе **XFS**.

Создан каталог `/mnt/groups`, после чего соответствующая запись добавлена в `/etc/fstab`, позволяя смонтировать логический том постоянно.

![Конфигурация fstab](Screenshot_13.png){ #fig:013 width=70% }

Проверка монтирования показала, что система корректно подключила файловую систему.

![Монтирование lvgroup](Screenshot_14.png){ #fig:014 width=70% }

После перезагрузки был создан физический том на разделе `/dev/sdc2`, который затем был добавлен в группу томов `vggroup`. Объём группы увеличился, что позволило расширить логический том.

Расширение логического тома выполнено на **+150 МБ**, при этом использовалось 100% свободного пространства:

![Расширение LV и файловой системы XFS](Screenshot_15.png){ #fig:015 width=70% }

Файловая система XFS была успешно расширена командой `xfs_growfs`, о чём свидетельствует вывод.

Состояние физических и логических томов подтверждено командами `pvs`, `vgs`, `lvs`, а также проверкой размеров файловых систем.

![Итоговая проверка томов и файловой системы](Screenshot_16.png){ #fig:016 width=70% }

Проверка параметров файловой системы в `df -h` показала успешное увеличение размера тома `lvgroup`, а также доступность нового пространства.

# Контрольные вопросы

**1. Какой тип раздела используется в разделе GUID для работы с LVM?**
Для LVM в GPT используется типовой GUID-раздел **Linux LVM** с идентификатором **8e**

**2. Какой командой можно создать группу томов с именем vggroup, которая содержит физическое устройство /dev/sdb3 и использует физический экстент 4 MiB?**

```
vgcreate -s 4M vggroup /dev/sdb3
```

**3. Какая команда показывает краткую сводку физических томов в вашей системе, а также группу томов, к которой они принадлежат?**
Используется команда:

```
pvs
```

**4. Что вам нужно сделать, чтобы добавить весь жёсткий диск /dev/sdd в группу томов?**
Необходимо:

1. Создать раздел типа Linux LVM (или использовать весь диск как PV).
2. Создать физический том:

   ```
   pvcreate /dev/sdd
   ```
3. Добавить его в существующую группу томов:

   ```
   vgextend <имя_VG> /dev/sdd
   ```

**5. Какая команда позволяет создать логический том lvvol1 с размером 6 MiB?**

```
lvcreate -n lvvol1 -L 6M <имя_VG>
```

**6. Какая команда позволяет добавить 100 МБ в логический том lvvol1, если пространство доступно?**

```
lvextend -L +100M /dev/<VG>/lvvol1
```

**7. Каков первый шаг, чтобы добавить ещё 200 МБ в логический том, если требуемое пространство недоступно?**
Сначала нужно увеличить группу томов, добавив новый физический том:

```
pvcreate <устройство>
vgextend <имя_VG> <устройство>
```

**8. Какую опцию нужно использовать с lvextend, чтобы также изменить размер файловой системы?**
Используется параметр:

```
lvextend -r
```

**9. Как посмотреть, какие логические тома доступны?**
Для просмотра используется команда:

```
lvs
```

**10. Какую команду нужно использовать для проверки целостности файловой системы на /dev/vgdata/lvdata?**
Зависит от типа файловой системы:

* Для ext4:

  ```
  e2fsck -f /dev/vgdata/lvdata
  ```
* Для XFS:

  ```
  xfs_repair /dev/vgdata/lvdata
  ```

# Заключение

В ходе работы были выполнены ключевые операции по управлению логическими томами в Linux. Были созданы разделы для LVM, на их основе — физические и групповые тома, сформирован логический том и настроено его постоянное монтирование. После перезагрузки выполнено расширение тома и файловой системы, что подтвердило гибкость и мощные возможности LVM при динамическом управлении дисковым пространством. Освоенные действия позволяют эффективно масштабировать хранилища и администрировать систему на уровне корпоративных решений.
