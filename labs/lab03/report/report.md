---
## Front matter
title: "Отчёт по лабораторной работе №4"
subtitle: "Работа с программными пакетами"
author: "Анастасия Мазуркевич"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки работы с репозиториями и менеджерами пакетов.

# Ход выполнения

## Работа с репозиториями

После перехода в каталог `/etc/yum.repos.d` были просмотрены доступные репозитории.  
Командой `ls` отобразился список файлов: **rocky-addons.repo**, **rocky-devel.repo**, **rocky-extras.repo**, **rocky.repo**.  
Для анализа был открыт файл `rocky.repo`, содержащий параметры подключения к зеркалам Rocky Linux.  
В нём указываются `mirrorlist`, проверка GPG-подписей (`gpgcheck=1`), а также ключи для верификации пакетов.  

![Содержимое конфигурации репозитория](01.png){ #fig:001 width=70% }

Далее был выведен список репозиториев командой `dnf repolist`.  
Результат показал три активных источника пакетов: **BaseOS**, **AppStream** и **Extras**.  
Каждый репозиторий содержит собственный набор пакетов, необходимых для работы системы и дополнительного ПО.  

Команда `dnf search user` позволила найти пакеты, в названии или описании которых встречается слово **user**.  
В результатах отобразились утилиты и библиотеки, связанные с управлением пользователями, например: **libuser**, **usermode**, **xdg-user-dirs**.  

![Поиск пакетов по ключевому слову user](02.png){ #fig:002 width=70% }

Для начала был выполнен поиск с помощью `dnf search nmap` и просмотр информации через `dnf info nmap`.  
Команда показала подробные сведения: версию (7.92), репозиторий (AppStream), архитектуру (x86_64) и назначение (сканер сетей и утилита для аудита безопасности).  

![Информация о пакете nmap](03.png){ #fig:003 width=70% }

Установка производилась командами `dnf install nmap` и `dnf install nmap\*`.  
Разница заключается в следующем:  
- `dnf install nmap` устанавливает только основной пакет **nmap**.  
- `dnf install nmap\*` устанавливает все пакеты, имена которых начинаются с `nmap` (например, **nmap-ncat**).  

![Установка nmap и nmap-ncat](04.png){ #fig:004 width=70% }

Удаление производилось командами `dnf remove nmap` и `dnf remove nmap\*`.  
Первая команда удаляет сам пакет **nmap**, а вторая — весь набор, включая дополнительные компоненты (например, `nmap-ncat`).  

![Удаление пакета nmap](05.png){ #fig:005 width=70% }

Сначала был выведен список доступных групп командой `dnf groups list`.  
Результат показал как **окружения** (Server, Workstation, Minimal Install), так и **группы** (например, Development Tools, Security Tools).  

![Список групп пакетов](06.png){ #fig:006 width=70% }

Для получения информации о конкретной группе использовалась команда `dnf groups info "RPM Development Tools"`.  
Она показала, что группа включает пакеты **redhat-rpm-config**, **rpm-build**, **rpmdevtools**.  

![Информация о группе RPM Development Tools](07.png){ #fig:007 width=70% }

Далее группа была установлена командой `dnf groupinstall "RPM Development Tools"`.  
В процессе добавились пакеты **rpmdevtools** и зависимость **python3-argcomplete**.  

Удаление группы выполнялось через `dnf groupremove "RPM Development Tools"`.  

![Установка и удаление группы пакетов](08.png){ #fig:008 width=70% }

## История команд dnf

Команда `dnf history` отобразила все выполненные действия: установка и удаление пакетов, а также работа с группами.  
Для отката последнего действия (например, шестого) использовалась команда `dnf history undo 6`.  
Это позволило вернуть удалённые ранее пакеты.  

![История dnf и откат изменений](09.png){ #fig:009 width=70% }

## Использование rpm

Сначала был выполнен поиск пакета `lynx` с помощью команды `dnf list lynx`.  
Затем пакет был загружен без установки опцией `--downloadonly`.  

![Загрузка пакета lynx](10.png){ #fig:010 width=70% }

Для поиска rpm-файла применялась команда `find /var/cache/dnf/ -name lynx*`.  
Результат показал, что пакет был сохранён в каталог `/var/cache/dnf/appstream.../packages/`.  

После перехода в каталог с пакетом был выполнен его установочный запуск через `rpm -Uhv lynx-2.9.0-6.el10.x86_64.rpm`.  
Процесс завершился успешно, и пакет был установлен в систему.  

![Установка lynx через rpm](11.png){ #fig:011 width=70% }

С помощью команды `which lynx` было определено расположение исполняемого файла — `/bin/lynx`.  
Команда `rpm -qf $(which lynx)` подтвердила, что файл принадлежит пакету **lynx**.  
Дополнительная информация о пакете была получена через `rpm -qi lynx`: версия 2.9.0, архитектура x86_64, лицензия GPL-2.0, описание как текстового веб-браузера.  

Команда `rpm -ql lynx` отобразила полный перечень файлов пакета, включая бинарные файлы, документацию и конфигурацию.  
Для выделения документации использовалась команда `rpm -qd lynx`, которая показала размещение файлов в `/usr/share/doc/lynx`.  

![Файлы пакета lynx](12.png){ #fig:012 width=70% }  
![Документация пакета lynx](13.png){ #fig:013 width=70% }

Также был изучен встроенный man-мануал `man lynx`, предоставляющий описание и параметры запуска программы.  

![Руководство man по lynx](14.png){ #fig:014 width=70% }

Запуск браузера `lynx` под обычным пользователем открыл стартовую страницу Rocky Linux, что подтвердило корректность установки.  

![Работа lynx в терминале](15.png){ #fig:015 width=70% }

Команда `rpm -qc lynx` вывела список конфигурационных файлов: `/etc/lynx-site.cfg`, `/etc/lynx.cfg`, `/etc/lynx.lss`.  
Скрипты установки проверялись через `rpm -q --scripts lynx`, однако дополнительных скриптов в пакете не оказалось.  

Удаление пакета выполнялось командой `rpm -e lynx`.  
После этого проверка содержимого каталога показала, что пакет был успешно удалён.  

![Удаление пакета lynx](16.png){ #fig:016 width=70% }

## Установка пакета dnsmasq

Сначала был выполнен поиск пакета с помощью команды `dnf list dnsmasq`.  
После этого пакет был установлен через `dnf install dnsmasq`.  
Местоположение исполняемого файла определено командой `which dnsmasq`, результат — `/sbin/dnsmasq`.  

Команда `rpm -qf $(which dnsmasq)` подтвердила, что бинарный файл относится к пакету **dnsmasq**.  
Более детальные сведения получены через `rpm -qi dnsmasq`:  
- версия 2.90,  
- архитектура x86_64,  
- лицензия GPL-2.0,  
- назначение — DNS-, DHCP- и TFTP-сервер.  

![Информация о пакете dnsmasq](17.png){ #fig:017 width=70% }

Команда `rpm -ql dnsmasq` вывела полный список файлов, входящих в пакет: бинарные файлы, службы systemd, конфигурации и документацию.  

![Список файлов пакета dnsmasq](18.png){ #fig:018 width=70% }

Отдельно список документации был получен через `rpm -qd dnsmasq`, в котором присутствуют файлы `CHANGES`, `FAQ`, `doc.html`, `setup.html` и man-страница.  

![Документация пакета dnsmasq](19.png){ #fig:019 width=70% }

Для изучения возможностей программы был открыт встроенный man-мануал `man dnsmasq`.  

![Руководство man по dnsmasq](20.png){ #fig:020 width=70% }

С помощью команды `rpm -qc dnsmasq` определены конфигурационные файлы:  
- `/etc/dnsmasq.conf`  
- `/etc/dbus-1/system.d/dnsmasq.conf`  
- каталог `/etc/dnsmasq.d`  

![Конфигурационные файлы пакета dnsmasq](21.png){ #fig:025 width=70% }

Команда `rpm -q --scripts dnsmasq` показала наличие скриптов:  
- **preinstall** — создание системного пользователя и группы `dnsmasq`, необходимых для корректного запуска службы;  
- **postinstall** — регистрация службы в systemd;  
- **preuninstall** и **postuninstall** — удаление службы и очистка настроек при удалении пакета.  

Для удаления пакета использовалась команда `rpm -e dnsmasq`.  
После удаления команда `ls` подтвердила, что rpm-файл отсутствует в системе.  

# Контрольные вопросы

**1. Какая команда позволяет вам искать пакет rpm, содержащий файл useradd?**  
Для этого используется команда:  
- `rpm -qf $(which useradd)` — если файл уже установлен;  
- либо `dnf provides */useradd` — для поиска пакета, в котором содержится бинарный файл `useradd`.  

**2. Какие команды вам нужно использовать, чтобы показать имя группы dnf, которая содержит инструменты безопасности и показывает, что находится в этой группе?**  
- `dnf group list` — показывает все группы пакетов, включая **Security Tools**.  
- `dnf group info "Security Tools"` — отображает содержимое выбранной группы.  

**3. Какая команда позволяет вам установить rpm, который вы загрузили из Интернета и который не находится в репозиториях?**  
Для этого используется:  
- `rpm -Uvh имя_пакета.rpm` — установка пакета напрямую.  
Либо через dnf (с автоматическим разрешением зависимостей):  
- `dnf install ./имя_пакета.rpm`  

**4. Вы хотите убедиться, что пакет rpm, который вы загрузили, не содержит никакого опасного кода сценария. Какая команда позволяет это сделать?**  
Необходимо просмотреть скрипты, встроенные в пакет:  
- `rpm -q --scripts имя_пакета`  
Эта команда показывает preinstall, postinstall, preuninstall и postuninstall-скрипты.  

**5. Какая команда показывает всю документацию в rpm?**  
Для этого используется:  
- `rpm -qd имя_пакета` — выводит список всех файлов документации (README, LICENSE, примеры).  

**6. Какая команда показывает, какому пакету rpm принадлежит файл?**  
Для этого применяется:  
- `rpm -qf /путь/к/файлу`  
Например: `rpm -qf /usr/sbin/dnsmasq` 
 
# Заключение

В ходе работы были изучены способы управления пакетами в Linux с использованием `dnf` и `rpm`.  
Были освоены операции поиска, установки и удаления пакетов, работа с группами пакетов, просмотр истории действий.  
Кроме того, была рассмотрена структура rpm-пакетов: список файлов, документация, конфигурационные файлы и установочные скрипты.  
Полученные навыки позволяют администрировать систему, контролировать установку программ и обеспечивать её безопасность.
